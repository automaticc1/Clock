<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADHD Focus Timer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.22.5/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
        }
        
        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            transition: all 0.5s ease;
        }
        
        .content {
            width: 100%;
            max-width: 28rem;
            margin: 0 auto;
            text-align: center;
        }
        
        .space-y-8 > * + * { margin-top: 2rem; }
        .space-y-6 > * + * { margin-top: 1.5rem; }
        .space-y-4 > * + * { margin-top: 1rem; }
        .space-y-3 > * + * { margin-top: 0.75rem; }
        .space-y-2 > * + * { margin-top: 0.5rem; }
        
        .btn {
            border: none;
            cursor: pointer;
            font-family: inherit;
            font-weight: 600;
            border-radius: 0.75rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }
        
        .btn:hover {
            transform: scale(1.05);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-primary {
            width: 100%;
            padding: 1.5rem 2rem;
            font-size: 1.25rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .btn-secondary {
            width: 100%;
            padding: 1rem 1.5rem;
            font-size: 1.125rem;
            background: rgba(255,255,255,0.2);
        }
        
        .btn-small {
            padding: 0.5rem 1.5rem;
            font-size: 1rem;
        }
        
        .timer {
            font-size: 5rem;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            line-height: 1;
        }
        
        @media (max-width: 768px) {
            .timer {
                font-size: 4rem;
            }
        }
        
        .text-4xl { font-size: 2.25rem; font-weight: bold; }
        .text-2xl { font-size: 1.5rem; font-weight: 600; }
        .text-xl { font-size: 1.25rem; font-weight: 600; }
        .text-lg { font-size: 1.125rem; }
        .text-sm { font-size: 0.875rem; }
        
        .opacity-80 { opacity: 0.8; }
        .opacity-70 { opacity: 0.7; }
        .opacity-60 { opacity: 0.6; }
        
        .flex { display: flex; }
        .flex-gap-3 { gap: 0.75rem; }
        .flex-gap-2 { gap: 0.5rem; }
        .items-center { align-items: center; }
        
        .text-left { text-align: left; }
        
        .textarea {
            width: 100%;
            padding: 0.75rem;
            border-radius: 0.5rem;
            background: rgba(255,255,255,0.2);
            border: none;
            outline: none;
            resize: none;
            font-family: inherit;
            font-size: 1rem;
        }
        
        .textarea::placeholder {
            opacity: 0.6;
        }
        
        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            z-index: 50;
        }
        
        .modal {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            max-width: 24rem;
            margin: 0 auto;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            color: #1f2937;
        }
        
        .icon {
            width: 1.25rem;
            height: 1.25rem;
            display: inline-block;
        }
        
        .icon-lg {
            width: 1.75rem;
            height: 1.75rem;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const PlayIcon = () => (
            <svg className="icon-lg" fill="currentColor" viewBox="0 0 24 24">
                <path d="M8 5v14l11-7z"/>
            </svg>
        );

        const SquareIcon = () => (
            <svg className="icon" fill="currentColor" viewBox="0 0 24 24">
                <rect x="6" y="6" width="12" height="12"/>
            </svg>
        );

        const CheckCircleIcon = () => (
            <svg className="icon" fill="currentColor" viewBox="0 0 24 24">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22,4 12,14.01 9,11.01"/>
            </svg>
        );

        const AlertCircleIcon = () => (
            <svg className="icon" fill="currentColor" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
        );

        const ADHDTimerApp = () => {
            const [phase, setPhase] = useState('idle');
            const [activationTime, setActivationTime] = useState(15 * 60);
            const [focusTime, setFocusTime] = useState(0);
            const [isRunning, setIsRunning] = useState(false);
            const [showPrompt, setShowPrompt] = useState(false);
            const [lastPromptTime, setLastPromptTime] = useState(0);
            
            const [reflection, setReflection] = useState({
                meaningful: null,
                perfectionism: null,
                nextTask: ''
            });

            const intervalRef = useRef(null);

            useEffect(() => {
                if (isRunning) {
                    intervalRef.current = setInterval(() => {
                        if (phase === 'activation') {
                            setActivationTime(prev => {
                                if (prev <= 1) {
                                    setPhase('focus');
                                    setFocusTime(0);
                                    setLastPromptTime(0);
                                    return 0;
                                }
                                return prev - 1;
                            });
                        } else if (phase === 'focus') {
                            setFocusTime(prev => {
                                const newTime = prev + 1;
                                if (newTime > 0 && newTime % 600 === 0 && newTime !== lastPromptTime) {
                                    setShowPrompt(true);
                                    setLastPromptTime(newTime);
                                }
                                return newTime;
                            });
                        }
                    }, 1000);
                } else {
                    clearInterval(intervalRef.current);
                }

                return () => clearInterval(intervalRef.current);
            }, [isRunning, phase, lastPromptTime]);

            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            const startSession = () => {
                setPhase('activation');
                setActivationTime(15 * 60);
                setFocusTime(0);
                setIsRunning(true);
                setShowPrompt(false);
                setLastPromptTime(0);
                setReflection({ meaningful: null, perfectionism: null, nextTask: '' });
            };

            const stopSession = () => {
                setIsRunning(false);
                setPhase('reflection');
                setShowPrompt(false);
            };

            const finishReflection = () => {
                const sessionData = {
                    date: new Date().toISOString(),
                    activationTime: 15 * 60 - activationTime,
                    focusTime: focusTime,
                    reflection: reflection
                };
                
                const sessions = JSON.parse(localStorage.getItem('adhd-timer-sessions') || '[]');
                sessions.push(sessionData);
                localStorage.setItem('adhd-timer-sessions', JSON.stringify(sessions));
                
                setPhase('idle');
                setActivationTime(15 * 60);
                setFocusTime(0);
            };

            const dismissPrompt = () => {
                setShowPrompt(false);
            };

            const getPhaseStyles = () => {
                switch (phase) {
                    case 'activation':
                        return {
                            background: 'linear-gradient(135deg, #ff6b35, #f7931e)',
                            color: 'white',
                            accent: '#ff8c42'
                        };
                    case 'focus':
                        return {
                            background: 'linear-gradient(135deg, #667eea, #764ba2)',
                            color: 'white',
                            accent: '#5a67d8'
                        };
                    default:
                        return {
                            background: 'linear-gradient(135deg, #2d3748, #4a5568)',
                            color: 'white',
                            accent: '#4299e1'
                        };
                }
            };

            const styles = getPhaseStyles();

            return (
                <div className="app-container" style={{ background: styles.background }}>
                    <div className="content">
                        
                        {/* Idle State */}
                        {phase === 'idle' && (
                            <div className="space-y-8">
                                <div>
                                    <h1 className="text-4xl" style={{ color: styles.color, marginBottom: '0.5rem' }}>
                                        Focus Timer
                                    </h1>
                                    <p className="text-lg opacity-80" style={{ color: styles.color }}>
                                        Beat procrastination, avoid perfectionism
                                    </p>
                                </div>
                                
                                <button
                                    onClick={startSession}
                                    className="btn btn-primary"
                                    style={{ backgroundColor: styles.accent, color: 'white' }}
                                >
                                    <PlayIcon />
                                    Start Work Session
                                </button>
                                
                                <div className="text-sm opacity-60 space-y-2" style={{ color: styles.color }}>
                                    <p>• 15-min activation phase to get started</p>
                                    <p>• Unlimited focus time with gentle check-ins</p>
                                    <p>• Quick reflection to build awareness</p>
                                </div>
                            </div>
                        )}

                        {/* Activation Phase */}
                        {phase === 'activation' && (
                            <div className="space-y-8">
                                <div>
                                    <h2 className="text-2xl" style={{ color: styles.color, marginBottom: '0.5rem' }}>
                                        Activation Zone
                                    </h2>
                                    <p className="text-lg opacity-80" style={{ color: styles.color }}>
                                        Just get moving - progress over perfection
                                    </p>
                                </div>
                                
                                <div className="timer" style={{ color: styles.color }}>
                                    {formatTime(activationTime)}
                                </div>
                                
                                <div className="text-lg opacity-70" style={{ color: styles.color }}>
                                    Start anything. The goal is motion, not perfection.
                                </div>
                                
                                <button
                                    onClick={stopSession}
                                    className="btn btn-secondary"
                                    style={{ backgroundColor: 'rgba(255,255,255,0.2)', color: styles.color }}
                                >
                                    <SquareIcon />
                                    Stop Session
                                </button>
                            </div>
                        )}

                        {/* Focus Phase */}
                        {phase === 'focus' && (
                            <div className="space-y-8">
                                <div>
                                    <h2 className="text-2xl" style={{ color: styles.color, marginBottom: '0.5rem' }}>
                                        Deep Focus Mode
                                    </h2>
                                    <p className="text-lg opacity-80" style={{ color: styles.color }}>
                                        You're in the zone. Stay present.
                                    </p>
                                </div>
                                
                                <div className="timer" style={{ color: styles.color }}>
                                    {formatTime(focusTime)}
                                </div>
                                
                                <div className="text-lg opacity-70" style={{ color: styles.color }}>
                                    Keep momentum going. You've got this.
                                </div>
                                
                                <button
                                    onClick={stopSession}
                                    className="btn btn-secondary"
                                    style={{ backgroundColor: 'rgba(255,255,255,0.2)', color: styles.color }}
                                >
                                    <SquareIcon />
                                    Stop Session
                                </button>
                            </div>
                        )}

                        {/* Reflection Phase */}
                        {phase === 'reflection' && (
                            <div className="space-y-6">
                                <h2 className="text-2xl" style={{ color: styles.color, marginBottom: '1rem' }}>
                                    Session Reflection
                                </h2>
                                
                                <div className="space-y-6 text-left">
                                    {/* Question 1 */}
                                    <div>
                                        <p className="text-lg flex items-center flex-gap-2" style={{ color: styles.color, marginBottom: '0.75rem' }}>
                                            <CheckCircleIcon />
                                            Did you start something meaningful?
                                        </p>
                                        <div className="flex flex-gap-3">
                                            {['Yes', 'No'].map(option => (
                                                <button
                                                    key={option}
                                                    onClick={() => setReflection({...reflection, meaningful: option})}
                                                    className={`btn btn-small ${reflection.meaningful === option ? '' : 'opacity-60'}`}
                                                    style={{ 
                                                        backgroundColor: reflection.meaningful === option ? styles.accent : 'rgba(255,255,255,0.2)',
                                                        color: styles.color 
                                                    }}
                                                >
                                                    {option}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Question 2 */}
                                    <div>
                                        <p className="text-lg flex items-center flex-gap-2" style={{ color: styles.color, marginBottom: '0.75rem' }}>
                                            <AlertCircleIcon />
                                            Did you get stuck perfecting details?
                                        </p>
                                        <div className="flex flex-gap-3">
                                            {['Yes', 'No', 'Unsure'].map(option => (
                                                <button
                                                    key={option}
                                                    onClick={() => setReflection({...reflection, perfectionism: option})}
                                                    className={`btn btn-small ${reflection.perfectionism === option ? '' : 'opacity-60'}`}
                                                    style={{ 
                                                        backgroundColor: reflection.perfectionism === option ? styles.accent : 'rgba(255,255,255,0.2)',
                                                        color: styles.color 
                                                    }}
                                                >
                                                    {option}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Question 3 */}
                                    <div>
                                        <p className="text-lg" style={{ color: styles.color, marginBottom: '0.75rem' }}>
                                            📝 What's next? (optional)
                                        </p>
                                        <textarea
                                            value={reflection.nextTask}
                                            onChange={(e) => setReflection({...reflection, nextTask: e.target.value})}
                                            placeholder="Jot down your next action or thought..."
                                            className="textarea"
                                            style={{ color: styles.color }}
                                            rows="3"
                                        />
                                    </div>
                                </div>

                                <button
                                    onClick={finishReflection}
                                    disabled={!reflection.meaningful || !reflection.perfectionism}
                                    className="btn btn-primary"
                                    style={{ 
                                        backgroundColor: reflection.meaningful && reflection.perfectionism ? styles.accent : 'rgba(255,255,255,0.3)',
                                        color: styles.color 
                                    }}
                                >
                                    Complete Session
                                </button>
                            </div>
                        )}

                        {/* 10-minute prompt overlay */}
                        {showPrompt && (
                            <div className="overlay">
                                <div className="modal">
                                    <h3 className="text-xl" style={{ marginBottom: '1rem' }}>
                                        Quick Check-in
                                    </h3>
                                    <p style={{ color: '#6b7280', marginBottom: '1.5rem' }}>
                                        Are you refining or avoiding?<br/>
                                        Still focused on what matters?
                                    </p>
                                    <button
                                        onClick={dismissPrompt}
                                        className="btn btn-primary"
                                        style={{ backgroundColor: '#3b82f6', color: 'white' }}
                                    >
                                        Back to Focus
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ADHDTimerApp />, document.getElementById('root'));
    </script>
</body>
</html>